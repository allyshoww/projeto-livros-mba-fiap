# API P√∫blica de Consulta de Livros

## Vis√£o Geral

Este projeto implementa um pipeline completo de dados ‚Äî da extra√ß√£o por web scraping √† disponibiliza√ß√£o via API RESTful ‚Äî para alimentar sistemas de recomenda√ß√£o de livros e cientistas de dados.

**Objetivo:**  
Extrair todos os livros de https://books.toscrape.com, armazenar localmente em CSV e disponibiliz√°-los de forma organizada e acess√≠vel via API p√∫blica.

## Arquitetura & Pipeline

1. **Extra√ß√£o**: Script automatizado de web scraping com Python
2. **Armazenamento**: Dados salvos em `data/books.csv`
3. **API**: FastAPI servindo os dados para consumo
4. **Deploy**: Pronto para deploy em plataformas cloud

## Estrutura do Projeto

```
Projeto Livros/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ main.py              # API FastAPI
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ scrape_books.py      # Script de web scraping
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ books.csv            # Dados extra√≠dos (gerado ap√≥s scraping)
‚îú‚îÄ‚îÄ docs/                    # Documenta√ß√£o adicional
‚îÇ   ‚îî‚îÄ‚îÄ PIPELINE_DIAGRAM.md  # Diagramas do pipeline
‚îú‚îÄ‚îÄ tests/                   # Testes (opcional)
‚îú‚îÄ‚îÄ requirements.txt         # Depend√™ncias Python
‚îú‚îÄ‚îÄ ARQUITETURA.md          # Plano arquitetural completo
‚îî‚îÄ‚îÄ README.md               # Este arquivo
```

## Instala√ß√£o e Configura√ß√£o

### 1. Clone o reposit√≥rio
```bash
git clone <url-do-repositorio>
cd "Projeto Livros"
```

### 2. Instale as depend√™ncias
```bash
pip install -r requirements.txt
```

### 3. Execute o web scraping
```bash
python scripts/scrape_books.py
```

### 4. Inicie a API
```bash
uvicorn api.main:app --reload
```

A API estar√° dispon√≠vel em: http://localhost:8000

## Endpoints da API

### Health Check
- `GET /api/v1/health` - Verifica status da API

### Livros
- `GET /api/v1/books` - Lista livros com pagina√ß√£o
  - Par√¢metros: `skip` (padr√£o: 0), `limit` (padr√£o: 20)
- `GET /api/v1/books/{book_id}` - Detalhes de um livro espec√≠fico
- `GET /api/v1/books/search` - Busca livros por t√≠tulo e/ou categoria
  - Par√¢metros: `title`, `category`

### Categorias
- `GET /api/v1/categories` - Lista todas as categorias dispon√≠veis

## Documenta√ß√£o da API

Acesse a documenta√ß√£o interativa em:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## Dados Extra√≠dos

O script de scraping coleta as seguintes informa√ß√µes de cada livro:
- **title**: T√≠tulo do livro
- **price**: Pre√ßo em libras (¬£)
- **rating**: Avalia√ß√£o de 0 a 5 estrelas
- **availability**: Status de disponibilidade
- **category**: Categoria do livro
- **image_url**: URL da imagem da capa

## Tecnologias Utilizadas

- **Python 3.x**
- **FastAPI**: Framework web moderno e r√°pido
- **BeautifulSoup4**: Web scraping
- **Pandas**: Manipula√ß√£o de dados
- **Requests**: Requisi√ß√µes HTTP
- **Uvicorn**: Servidor ASGI

## Deploy no Vercel

### Pr√©-requisitos
1. Conta no [Vercel](https://vercel.com)
2. [Vercel CLI](https://vercel.com/cli) instalado (opcional)
3. Git configurado

### Passos para Deploy

1. **Execute o scraping localmente** (dados s√£o necess√°rios para a API):
```bash
python scripts/scrape_books.py
```

2. **Remova o CSV do .gitignore temporariamente**:
```bash
# Comente a linha no .gitignore:
# data/books.csv
```

3. **Fa√ßa push para o GitHub**:
```bash
git add .
git commit -m "Deploy inicial"
git push origin main
```

4. **Deploy via Vercel Dashboard**:
- Acesse [vercel.com](https://vercel.com)
- Conecte seu reposit√≥rio GitHub
- Clique em "Deploy"

**OU via CLI:**
```bash
npx vercel
```

### Arquivos de Deploy
- `vercel.json`: Configura√ß√£o do Vercel
- `requirements.txt`: Lista as depend√™ncias

### URLs da Aplica√ß√£o
- API: `https://seu-projeto.vercel.app`
- Docs: `https://seu-projeto.vercel.app/docs`

### Valida√ß√£o do Deploy

Ap√≥s o deploy, valide se a API est√° funcionando:

#### Teste Manual (R√°pido)
```bash
curl https://seu-projeto.vercel.app/api/v1/health
```

#### Teste Automatizado (Completo)
```bash
python validate_api.py https://seu-projeto.vercel.app
```

**O script `validate_api.py` testa automaticamente:**
- ‚úÖ Health check
- ‚úÖ Listagem de livros
- ‚úÖ Busca por t√≠tulo
- ‚úÖ Busca por categoria
- ‚úÖ Livro espec√≠fico
- ‚úÖ Lista de categorias
- ‚úÖ Documenta√ß√£o Swagger

**Exemplo de sa√≠da:**
```
üîç Testando API em: https://seu-projeto.vercel.app
--------------------------------------------------
Health Check         ‚úÖ OK
Listar Livros        ‚úÖ OK
Buscar por T√≠tulo    ‚úÖ OK
Buscar por Categoria ‚úÖ OK
Livro Espec√≠fico     ‚úÖ OK
Categorias           ‚úÖ OK
Documenta√ß√£o         ‚úÖ OK
--------------------------------------------------
Resultado: 7/7 testes passaram
üéâ API funcionando perfeitamente!
```

## Exemplos de Uso com Requests/Responses

### 1. Health Check
**Request:**
```bash
GET /api/v1/health
```
**Response:**
```json
{
  "status": "ok",
  "message": "API funcionando normalmente."
}
```

### 2. Listar Livros
**Request:**
```bash
GET /api/v1/books?limit=2&skip=0
```
**Response:**
```json
[
  {
    "id": 1,
    "title": "It's Only the Himalayas",
    "price": 45.17,
    "rating": 2,
    "availability": "In stock",
    "category": "Travel",
    "image_url": "https://books.toscrape.com/media/cache/27/a5/27a53d0bb95bdd88288eaf66c9230d7e.jpg"
  },
  {
    "id": 2,
    "title": "Full Moon over Noah's Ark",
    "price": 49.43,
    "rating": 4,
    "availability": "In stock",
    "category": "Travel",
    "image_url": "https://books.toscrape.com/media/cache/57/77/57770cac1628f4407636635f4b85e88c.jpg"
  }
]
```

### 3. Buscar Livros
**Request:**
```bash
GET /api/v1/books/search?category=Fiction&title=the
```
**Response:**
```json
[
  {
    "id": 15,
    "title": "The Coming Woman: A Novel Based on the Life of the Infamous Feminist, Victoria Woodhull",
    "price": 17.93,
    "rating": 3,
    "availability": "In stock",
    "category": "Fiction",
    "image_url": "https://books.toscrape.com/media/cache/3d/54/3d54940e57e662c4dd1f3ff00c78cc64.jpg"
  }
]
```

### 4. Livro Espec√≠fico
**Request:**
```bash
GET /api/v1/books/1
```
**Response:**
```json
{
  "id": 1,
  "title": "It's Only the Himalayas",
  "price": 45.17,
  "rating": 2,
  "availability": "In stock",
  "category": "Travel",
  "image_url": "https://books.toscrape.com/media/cache/27/a5/27a53d0bb95bdd88288eaf66c9230d7e.jpg"
}
```

### 5. Listar Categorias
**Request:**
```bash
GET /api/v1/categories
```
**Response:**
```json
{
  "categories": [
    "Travel",
    "Mystery",
    "Historical Fiction",
    "Sequential Art",
    "Classics",
    "Philosophy"
  ]
}
```

### C√≥digo Python de Exemplo
```python
import requests

# Listar primeiros 10 livros
response = requests.get("http://localhost:8000/api/v1/books?limit=10")
books = response.json()

# Buscar livros por categoria
response = requests.get("http://localhost:8000/api/v1/books/search?category=Fiction")
fiction_books = response.json()

# Obter detalhes de um livro espec√≠fico
response = requests.get("http://localhost:8000/api/v1/books/1")
book_details = response.json()
```

## Contribui√ß√£o

1. Fork o projeto
2. Crie uma branch para sua feature
3. Commit suas mudan√ßas
4. Push para a branch
5. Abra um Pull Request

## Licen√ßa

Este projeto est√° sob a licen√ßa MIT.# projeto-livros-mba-fiap
